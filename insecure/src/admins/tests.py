from django.test import TestCase
from django.urls import reverse
from django.db import connection

# Create your tests here.

class AdminsTestCase(TestCase):
    def setUp(self):
        cursor = connection.cursor()
        cursor.execute("CREATE TABLE common_users(\
            username varchar(100),\
            password varchar(100),\
            name varchar(100),\
            email varchar(100),\
            role varchar(100),\
            filedir varchar(100),\
            address text);")
        cursor.execute("CREATE TABLE login(\
	        username varchar(100),\
	        status varchar(100) default 'logged out'\
        )")
        cursor.execute("CREATE TABLE enquiry(\
            name varchar(100),\
            email varchar(100),\
            enquiry text,\
            datetime varchar(100),\
            enquiryid varchar(100)\
        )")
        cursor.execute("INSERT INTO common_users(username, password, name, email, role, filedir,\
            address) VALUES ('A0', '0f359740bd1cda994f8b55330c86d845', 'Leslie Pro', 'S0@email.com', \
            'doctor', '/static/uploads/default.png', 'LOL ROAD st 52 blk 123 S123456');"\
        )
        cursor.execute("CREATE TABLE requests(\
	        doctorid varchar(100),\
	        patientid varchar(100),\
	        reason text,\
	        status NUMERIC DEFAULT 'pending'\
        )")
        cursor.execute("INSERT INTO login(username) VALUES ('S0');")

    def test_login_get(self):
        response = self.client.get('/%2Fadmins/login')
        self.assertEqual(response.status_code, 200)
    
    def test_login_post(self):
        data = {
            'usename': 'S0',
            'password': 'p@ssw0rd',
        }
        response = self.client.post('/%2Fadmins/login', data=data)
        self.assertEqual(response.status_code, 200)
    
    def test_new_users_get(self):
        response = self.client.get('/%2Fadmins/A0/newuser')
        self.assertEqual(response.status_code,200)
    
    def test_enquiries_get(self):
        response = self.client.get('/%2Fadmins/A0/enquiry')
        self.assertEqual(response.status_code,200)
    
    def test_request_get(self):
        response = self.client.get('/%2Fadmins/A0/requests')
        self.assertEqual(response.status_code, 200)

    def test_profile_get(self):
        response = self.client.get('/%2Fadmins/A0/profile')
        self.assertEqual(response.status_code, 200)
    
    def test_change_password_get(self):
        response = self.client.get('/%2Fadmins/A0/changepassword')
        self.assertEqual(response.status_code, 200)
    